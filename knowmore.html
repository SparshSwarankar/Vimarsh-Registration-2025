<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vimarsh 2024 Brochure</title>
  <link rel="shortcut icon" href="/Images/Vimarsh2025 logo.jpg" type="image/x-icon">
  <link rel="stylesheet" href="/Mobile.css">
  <link rel="stylesheet" href="/style.css">
</head>

<body>
  <section class="brochure">
    <button class="nav-btn prev-btn" id="prevBtn"> < </button>
        <div class="book" id="book">
          <div class="pages">
            <!-- 8 PNG pages -->
            <div class="page active"><img src="/Vimarsh Brochure/1.png" alt="Page 1"></div>
            <div class="page"><img src="/Vimarsh Brochure/2.png" alt="Page 2"></div>
            <div class="page"><img src="/Vimarsh Brochure/3.png" alt="Page 3"></div>
            <div class="page"><img src="/Vimarsh Brochure/4.png" alt="Page 4"></div>
            <div class="page"><img src="/Vimarsh Brochure/5.png" alt="Page 5"></div>
            <div class="page"><img src="/Vimarsh Brochure/6.png" alt="Page 6"></div>
            <div class="page"><img src="/Vimarsh Brochure/7.png" alt="Page 7"></div>
            <div class="page"><img src="/Vimarsh Brochure/8.png" alt="Page 8"></div>
          </div>
        </div>
        <button class="nav-btn next-btn" id="nextBtn">></button>
  </section>

  <!-- Popups -->
  <div class="popup" id="dragPopup">ðŸ‘‰ Drag the page to flip</div>
  <div class="last-popup" id="lastPopup">ðŸ“– Youâ€™ve reached the last page of the brochure</div>

  <script>
    const pages = document.querySelectorAll(".page");
    let current = 0;
    let startX = 0;
    let isDragging = false;
    let flashShownCount = 0; // show popup max 3 times

    function showPage(index) {
      pages.forEach((p, i) => {
        p.classList.remove("active");
        if (i === index) {
          p.classList.add("active");
        }
      });

      // --- Show "last page" popup ---
      const lastPopup = document.getElementById("lastPopup");
      if (index === pages.length - 1 && lastPopup) {
        lastPopup.classList.add("show");
        setTimeout(() => {
          lastPopup.classList.remove("show");
        }, 4000);
      }
    }

    // Button navigation
    document.getElementById("nextBtn").addEventListener("click", () => {
      if (current < pages.length - 1) {
        current++;
        showPage(current);
      }
    });

    document.getElementById("prevBtn").addEventListener("click", () => {
      if (current > 0) {
        current--;
        showPage(current);
      }
    });

    // --- Drag system only on images ---
    pages.forEach((page) => {
      const img = page.querySelector("img");

      // prevent default browser drag
      img.addEventListener("dragstart", (e) => e.preventDefault());

      img.addEventListener("mousedown", (e) => {
        startX = e.clientX;
        isDragging = true;
        img.style.cursor = "grabbing";
      });

      img.addEventListener("mouseup", (e) => {
        if (!isDragging) return;
        let diff = e.clientX - startX;
        if (diff < -100 && current < pages.length - 1) {
          current++;
          showPage(current);
        } else if (diff > 100 && current > 0) {
          current--;
          showPage(current);
        }
        isDragging = false;
        img.style.cursor = "grab";
      });

      // Touch drag
      img.addEventListener("touchstart", (e) => {
        startX = e.touches[0].clientX;
        isDragging = true;
      });

      img.addEventListener("touchend", (e) => {
        if (!isDragging) return;
        let diff = e.changedTouches[0].clientX - startX;
        if (diff < -80 && current < pages.length - 1) {
          current++;
          showPage(current);
        } else if (diff > 80 && current > 0) {
          current--;
          showPage(current);
        }
        isDragging = false;
      });
    });

    // --- Show "drag to flip" popup only 3 times on first visit ---
    const popup = document.getElementById("dragPopup");
    function showDragPopup() {
      if (flashShownCount < 3) {
        flashShownCount++;
        popup.classList.add("show");
        setTimeout(() => {
          popup.classList.remove("show");
        }, 3000);
      }
    }

    // trigger first popup after 2s of page load, repeat 2 more times every 8s
    window.addEventListener("load", () => {
      setTimeout(() => {
        showDragPopup();
        let interval = setInterval(() => {
          if (flashShownCount >= 3) {
            clearInterval(interval);
          } else {
            showDragPopup();
          }
        }, 8000);
      }, 2000);
    });
  </script>


</body>

</html>